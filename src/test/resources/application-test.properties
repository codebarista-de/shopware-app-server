# allow bean overriding to use @TestConfiguration to replace beans in test context
spring.main.allow-bean-definition-overriding = true
logging.level.de.codebarista.shopware = DEBUG
spring.datasource.url = jdbc:sqlite:file:testdatabase.db?mode=memory&cache=shared


# Custom settings
app-backend.sdk.ssl-only = true
app-backend.sdk.map-localhost-ip-to-localhost-domain-name = false


# Spring boot settings
server.port = 8082
spring.jpa.database-platform = org.hibernate.community.dialect.SQLiteDialect
# Liquibase is used as schema manager (database creation, update...)
spring.jpa.hibernate.ddl-auto = none
# Don't use "Open Session In View" Pattern
spring.jpa.open-in-view = false
spring.datasource.driver-class-name = org.sqlite.JDBC
# SQLite cannot handle multiple connections
spring.datasource.hikari.maximum-pool-size = 1
# Timeout for getting a connection from the pool
spring.datasource.hikari.connection-timeout = 5000
# https://github.com/xerial/sqlite-jdbc/blob/master/src/main/java/org/sqlite/SQLiteConfig.java#L376
spring.datasource.hikari.data-source-properties.foreign_keys = true
# Timeout that the SQLite driver waits if a database table is locked (e.g. by litestream)
spring.datasource.hikari.data-source-properties.busy_timeout = 5000
spring.datasource.hikari.data-source-properties.journal_mode = WAL
spring.liquibase.change-log = classpath:db/changelog/db.changelog-master.xml
server.servlet.context-path = /

# Cache control of static files
spring.web.resources.cache.cachecontrol.max-age = 365d
spring.web.resources.cache.cachecontrol.cache-public = true

# Actuator
management.endpoint.health.enabled = true
management.endpoint.health.show-details = always
management.endpoint.health.show-components = always
management.endpoint.info.enabled = true
management.endpoints.web.exposure.include = health,info

# Monitoring user, permitted to access /actuator/** endpoints, random default password
spring.security.user.name = monitoring
spring.security.user.roles = MONITORING
spring.security.user.password = PASSWORD_TODO

# Disable Hot Reload
spring.devtools.restart.enabled = false

# Logging
logging.structured.format.console = ecs
